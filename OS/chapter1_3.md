## 1.3 操作系统运行环境

### 1.3.1 处理器运行模式

计算机系统中，CPU执行两种不同性质的程序：一种是**操作系统内核程序**；另一种是**用户自编程序**。内核程序要执行一些特权指令，而用户自编程序不能执行这些指令。

-   特权指令：是指不允许用户直接使用的指令，如I/O指令、置中断指令，存取用于内存保存的寄存器、送程序状态字到程序状态字寄存器等的指令。
-   非特权指令：是指允许用户直接使用的指令，它不能直接访问系统中的软硬件资源，仅限于访问用户的地址空间，这是为了防止用户程序对系统造成破坏。

CPU的运行模式划分为用户态和核心态。应用程序运行在用户态，操作系统内核程序运行在核心态。应用程序想操作系统请求服务时通过使用访管指令，从而产生一个中断事件将操作系统转换为核心态。

操作系统的各项功能分别被设置在了不同的层次上，与硬件关联紧密的模块，如时钟管理、中断处理、设备驱动等处于最底层。其次是运行频率较高的程序，如进程管理、存储器管理和设备管理等。这两部分构成了操作系统的内核，指令操作工作在核心态。

内核的四大功能：

1.   **时钟管理**

     时钟的第一功能是计时，操作系统需要通过时钟管理，向用户提供标准的系统时间。通过时钟中断的管理，可以实现进程的切换。

2.   **中断机制**

3.   **原语**

4.   **系统控制的数据结构及处理**